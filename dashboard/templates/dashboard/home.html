{% extends "dashboard/index.html" %}

{% load static i18n %}
{% load filters %}

{% block extra_css %}
    <link rel="stylesheet"
          href="{% static 'css/dashHome.css' %}?v={% now 'U' %}" />
    <link rel="stylesheet"
          href="{% static 'css/action_buttons.css' %}?v={% now 'U' %}" />
{% endblock extra_css %}

{% block dashContent %}

    {% if request.user.profile.role == "admin" %}
        {# Stats Cards Row #}
        <div class="container-fluid">
            <div class="row g-2 mb-4">
                <div class="col-lg-3 col-md-6 col-sm-6">
                    <div class="stats-card">
                        <div class="stats-icon bg-primary-subtle">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stats-info">
                            <h4>
                                {{ sellers.count|default:"0" }}
                            </h4>
                            <p>
                                {% trans "Total Sellers" %}
                            </p>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6 col-sm-6">
                    <div class="stats-card">
                        <div class="stats-icon bg-danger-subtle">
                            <i class="fas fa-store"></i>
                        </div>
                        <div class="stats-info">
                            <h4>
                                {{ waitlist.count|default:"0" }}
                            </h4>
                            <p>
                                {% trans "Total Waitlist" %}
                            </p>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6 col-sm-6">
                    <div class="stats-card">
                        <div class="stats-icon bg-warning-subtle">
                            <i class="fas fa-box-open"></i>
                        </div>
                        <div class="stats-info">
                            <h4>
                                {{ products.count|default:"0" }}
                            </h4>
                            <p>
                                {% trans "Total Products" %}
                            </p>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6 col-sm-6">
                    <div class="stats-card">
                        <div class="stats-icon bg-info-subtle">
                            <i class="fas fa-shipping-fast"></i>
                        </div>
                        <div class="stats-info">
                            <h4>
                                {{ orders.count|default:"0" }}
                            </h4>
                            <p>
                                {% trans "Delivered Orders" %}
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        {# Top Sellers Row #}
        <div class="row mt-4">
            <div class="col-lg-12">
                <div class="booking-card">
                    <div class="card-header">
                        <h5>
                            {% trans "Top Sellers" %}
                        </h5>
                        <a href="#" class="view-all">{% trans "View All" %}</a>
                    </div>

                    <div class="sellers-list p-3">
                        <div class="row g-4">
                            {# Seller 1 #}
                            <div class="col-lg-4 col-md-6 col-sm-12">
                                <div class="seller-modern-card">
                                    <div class="seller-tier premium">
                                        Premium
                                    </div>
                                    <div class="seller-main">
                                        <img src="https://randomuser.me/api/portraits/men/32.jpg"
                                             class="seller-avatar"
                                             alt="Seller" />
                                        <div class="seller-details">
                                            <h5>
                                                John Smith
                                            </h5>
                                            <div class="seller-meta">
                                                <span class="seller-email">john@example.com</span>
                                                <span class="seller-since">Since 2023</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="seller-stats">
                                        <div class="stat">
                                            <div class="stat-icon">
                                                ðŸšš
                                            </div>
                                            <div>
                                                <div class="stat-value">
                                                    245
                                                </div>
                                                <div class="stat-label">
                                                    Deliveries
                                                </div>
                                            </div>
                                        </div>
                                        <div class="stat">
                                            <div class="stat-icon">
                                                ðŸ“¦
                                            </div>
                                            <div>
                                                <div class="stat-value">
                                                    42
                                                </div>
                                                <div class="stat-label">
                                                    Products
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="seller-rating">
                                        <div class="stars">
                                            â˜…â˜…â˜…â˜…Â½
                                        </div>
                                        <div class="rating-value">
                                            4.5
                                        </div>
                                    </div>
                                </div>
                            </div>

                            {# Seller 2 #}
                            <div class="col-lg-4 col-md-6 col-sm-12">
                                <div class="seller-modern-card">
                                    <div class="seller-tier standard">
                                        Standard
                                    </div>
                                    <div class="seller-main">
                                        <img src="https://randomuser.me/api/portraits/women/44.jpg"
                                             class="seller-avatar"
                                             alt="Seller" />
                                        <div class="seller-details">
                                            <h5>
                                                Sarah Johnson
                                            </h5>
                                            <div class="seller-meta">
                                                <span class="seller-email">sarah@example.com</span>
                                                <span class="seller-since">Since 2022</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="seller-stats">
                                        <div class="stat">
                                            <div class="stat-icon">
                                                ðŸšš
                                            </div>
                                            <div>
                                                <div class="stat-value">
                                                    198
                                                </div>
                                                <div class="stat-label">
                                                    Deliveries
                                                </div>
                                            </div>
                                        </div>
                                        <div class="stat">
                                            <div class="stat-icon">
                                                ðŸ“¦
                                            </div>
                                            <div>
                                                <div class="stat-value">
                                                    35
                                                </div>
                                                <div class="stat-label">
                                                    Products
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="seller-rating">
                                        <div class="stars">
                                            â˜…â˜…â˜…â˜…â˜…
                                        </div>
                                        <div class="rating-value">
                                            5
                                        </div>
                                    </div>
                                </div>
                            </div>

                            {# Seller 3 #}
                            <div class="col-lg-4 col-md-6 col-sm-12">
                                <div class="seller-modern-card">
                                    <div class="seller-tier basic">
                                        Basic
                                    </div>
                                    <div class="seller-main">
                                        <img src="https://randomuser.me/api/portraits/men/75.jpg"
                                             class="seller-avatar"
                                             alt="Seller" />
                                        <div class="seller-details">
                                            <h5>
                                                Michael Brown
                                            </h5>
                                            <div class="seller-meta">
                                                <span class="seller-email">michael@example.com</span>
                                                <span class="seller-since">Since 2021</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="seller-stats">
                                        <div class="stat">
                                            <div class="stat-icon">
                                                ðŸšš
                                            </div>
                                            <div>
                                                <div class="stat-value">
                                                    176
                                                </div>
                                                <div class="stat-label">
                                                    Deliveries
                                                </div>
                                            </div>
                                        </div>
                                        <div class="stat">
                                            <div class="stat-icon">
                                                ðŸ“¦
                                            </div>
                                            <div>
                                                <div class="stat-value">
                                                    28
                                                </div>
                                                <div class="stat-label">
                                                    Products
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="seller-rating">
                                        <div class="stars">
                                            â˜…â˜…â˜…â˜…Â½
                                        </div>
                                        <div class="rating-value">
                                            4.5
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        {# Charts Row #}
        <div class="row mt-4">
            <div class="col-lg-6">
                <div class="booking-card">
                    <div class="card-header">
                        <h5>
                            {% trans "Sellers Per Day" %}
                        </h5>
                    </div>
                    <div class="card-body">
                        <canvas id="sellersChart" height="300"></canvas>
                    </div>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="booking-card">
                    <div class="card-header">
                        <h5>
                            {% trans "Deliveries Per Day" %}
                        </h5>
                    </div>
                    <div class="card-body">
                        <canvas id="deliveriesChart" height="300"></canvas>
                    </div>
                </div>
            </div>
        </div>
    {% elif request.user.profile.role == "seller" %}
        <div class="container-fluid">
            <div class="row g-2 mb-4">
                <div class="col-lg-4 col-md-6 col-sm-6">
                    <div class="stats-card">
                        <div class="stats-icon bg-primary-subtle">
                            <i class="fas fa-money-bills"></i>
                        </div>
                        <div class="stats-info">
                            <h4>
                                {{ delivered_revenue }}
                                <small class="text-muted">DZD</small>
                            </h4>
                            <p>
                                {% trans "Total Revenue" %}
                            </p>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4 col-md-6 col-sm-6">
                    <div class="stats-card">
                        <div class="stats-icon bg-warning-subtle">
                            <i class="fas fa-box-open"></i>
                        </div>
                        <div class="stats-info">
                            <h4>
                                {{ products.count|default:"0" }}/{{ subPlan.plan.max_products }}
                            </h4>
                            <p>
                                {% trans "Total Products" %}
                            </p>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4 col-md-6 col-sm-6">
                    <div class="stats-card">
                        <div class="stats-icon bg-info-subtle">
                            <i class="fas fa-shipping-fast"></i>
                        </div>
                        <div class="stats-info">
                            <h4>
                                {{ orders.count|default:"0" }}/{{ subPlan.plan.max_orders }}
                            </h4>
                            <p>
                                {% trans "Max Orders" %}
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="container-fluid">
            <div class="row gy-4">
                <!-- Revenue Chart -->
                <div class="col-lg-6">
                    <div class="card shadow-sm">
                        <div class="card-header">
                            <h5 class="mb-0">
                                {% trans "Revenue Over Time" %}
                            </h5>
                        </div>
                        <div class="card-body">
                            <canvas id="revenueChart" height="200"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Orders Summary -->
                <div class="col-lg-6">
                    <div class="card shadow-sm">
                        <div class="card-header">
                            <h5 class="mb-0">
                                {% trans "Orders Summary" %}
                            </h5>
                        </div>
                        <div class="card-body">
                            <canvas id="ordersChart" height="200"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Top Products -->
                <div class="col-lg-6 col-md-12">
                    <div class="card shadow-sm">
                        <div class="card-header">
                            <h5 class="mb-0">
                                {% trans "Top Products by Sales" %}
                            </h5>
                        </div>
                        <div class="card-body">
                            <canvas id="topProductsChart" height="150"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    {% endif %}


{% endblock dashContent %}
{% block extra_js %}
    <script src="{% static "js/dashHome.js" %}?v={% now "U" %}"></script>
    <script src="{% static "js/seller_charts.js" %}?v={% now "U" %}"></script>
{% endblock extra_js %}
